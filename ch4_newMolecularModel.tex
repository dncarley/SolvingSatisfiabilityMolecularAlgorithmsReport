
\chapter{A new molecular algorithm for {\sc Satisfiability}}

%<Paragraph> Introduce 
This chapter introduces a new molecular algorithm for {\sc Satisfiability}: the Distribution algorithm distributes literals from a CNF instance into a set of non-conflicting witnesses. 

\section{Distribution algorithm for {\sc Satisfiability}}

%	<Paragraph> Introduce Distribution algorithm	

The Distribution algorithm (Algorithm \ref{distributionAlgorithm}) begins with a CNF instance $\phi$.  The algorithm constructs sets of witnesses stored in $T_C$ that satisfy the current clause $C$ along with all previously evaluated witnesses in the tube $T_S$.  Once the Distribution completes the tube $T_S$ contain witnesses for $\phi$; when $\phi$ is unsatisfiable the tube $T_S = \emptyset$. \\

The algorithm begins by initiating a solution tube $T_S$ with a start sequence \texttt{S}.  During the evaluation of $m$ clauses\footnote{We consider only the parse ordering of the clauses from the CNF instance $\phi$.  The Distribution algorithm will resolve conflict uniquely depending on the permutations of the clauses in $\phi$.}, the tube stores witnesses for the CNF instance

\[
\bigwedge_{1\leq i \leq m} C_i.
\]

The tube $T_C$ stores witnesses for each clause.  The tube $T_C$ begins as the empty set on reading each clause $C$, and grows with the satisfying literal assignments.  

During the evaluation of each literal, we split the contents of $T_S$ into the tubes $T_V$ and a copy of $T_S$.  We use the tube $T_V$ to filter positive and negative literal assignments into the tubes $T_P$ and $T_F$, respectively.  The copy of the tube $T_S$ retains the witness candidates for each of the literals in $C$.

We extract from $T_V$ witnesses candidates that conflict with the current literal in the tube $T_F$, and those with idempotent assignments in the tube $T_P$.  The remaining contents of the tube $T_V$, if any, contain witness candidates that can witness the current clause with the assignment of the current literal $v$.  

The Distribution algorithm extends $T_V$ by appending the contents with the assignment $v_p$ in the same polarity of the current literal $v$.  We mix the clause witnesses ($T_C$) with the contents of the idempotent witnesses ($T_P$), extended witnesses ($T_V$), along with existing clause witnesses in $T_C$.

On each iteration of clauses, the Distribution algorithm clears the contents of the tube $T_S$ and passes the clause witnesses ($T_C$) to the remaining clauses.  We purify the contents of $T_S$ to create a uniform distribution of the witness candidates.  Once the Distribution algorithm completes the tube $T_S$ contains witnesses for $\phi$; if $T_S = \emptyset$ then $\phi$ is unsatisfiable.


\input{./algorithms/distributionAlgorithm.tex}
\FloatBarrier


	\subsection{Description of the Distribution algorithm}

Let us consider an example CNF instance designed to show several aspects of the Distribution algorithm.


\[
	\phi = (x_1 \vee x_2) \wedge (x_1 \vee \neg x_2 \vee x_3)
\]


This example demonstrates several key aspects of the algorithm.  We observe how the algorithm initiates the tube $T_S$  with literals from the first clause.  The second clause contains a literal of the same ($x_1$) and opposite polarity ($\neg x_2$) of the literals in the first clause.  The literal ($x_3$) demonstrates when the algorithm does match any existing literal assignments in $T_S$; causing the assignment of $(x_3)$ to be appended to all witness candidates in $T_V$.

With this example, we demonstrate filtering witness candidates in $T_V$ into the tubes $T_P$ and $T_N$.  The tube $T_N$ contains witness candidates that conflict with the current literal, and the tube $T_P$ contains witnesses for the current literal.  The remaining contents of $T_V$ contain witness candidates that do not contain the current literal.  We append the contents of $T_V$ with the current literal, and store the contents of $T_V \cup T_P$ as witnesses for the current clause in the tube $T_C$.

After each literal from a clause has been distributed, the contents of $T_C$ contain witnesses for both the current clause and all previously distributed clauses.  The contents of $T_C$ get stored as the tube $T_S$.  The tube $T_S$ stores the witness candidates for the next clause.  Once each clause has been distributed, the tube $T_S$ contains witnesses for the $k$-CNF instance $\phi$; if $T_S = \emptyset$, then $\phi$ is unsatisfiable.\\


Initiate the tube $T_S$ with a start medium \texttt{S}.
% 
%\begin{center}
%\begin{tikzpicture}
%\node[fill=lightgray, rounded corners=5pt, text width=3in]{
%	\[
%		T_S = \{\texttt{S}\}
%	\]
%};
%\end{tikzpicture}
%\end{center}


\begin{center}
\begin{tikzpicture}
\node[fill=lightgray, rounded corners=5pt, text width=3in]{
	
	\[
	T_S = \{
\texttt{S}
	\}
	\]
	\begin{align*}
	T_S = \{ 
&5'-\underbrace{\texttt{TTG}}_{\text{Start}}-3' \}
	\end{align*}
};
\end{tikzpicture}
\end{center}




Evaluate clause $C_1 = (x_1 \vee x_2)$:

\begin{center}
\begin{tikzpicture}
\node[fill=lightgray, rounded corners=5pt, text width=3in]{
	\[
		T_C = \{\texttt{ }\}
	\]
};
\end{tikzpicture}
\end{center}


Select the literal $x_1$ from $C_1$.  Split the contents of $T_S$:

\begin{center}
\begin{tikzpicture}
\node[fill=gray, rounded corners=5pt, text width=6in]{
	\makebox[\textwidth][r]{
		\begin{minipage}[t]{0.5\textwidth}
			\begin{center}
			\begin{tikzpicture}
			\node[fill=lightgray, rounded corners=5pt, text width=2.5in]{
				
				\[
				T_V = \{
			\texttt{S}
				\}
				\]
				\begin{align*}
				T_V = \{ 
			&5'-\underbrace{\texttt{TTG}}_{\text{Start}}-3' \}
				\end{align*}
			};
			\end{tikzpicture}
			\end{center}			
		\end{minipage}				
		\begin{minipage}[t]{0.5\textwidth}
			\begin{center}
			\begin{tikzpicture}
			\node[fill=lightgray, rounded corners=5pt, text width=2.5in]{
				
				\[
				T_S = \{
			\texttt{S}
				\}
				\]
				\begin{align*}
				T_S = \{ 
			&5'-\underbrace{\texttt{TTG}}_{\text{Start}} -3' \}
				\end{align*}
			};
			\end{tikzpicture}
			\end{center}			
		\end{minipage}		
	}
};
\end{tikzpicture}
\end{center}
	
\hspace{1em}

Extract literals from $T_V$ that contain negative and positive assignments for $x_1$.

\begin{center}
\begin{tikzpicture}
\node[fill=lightgray, rounded corners=5pt, text width=3in]{
	\begin{align*}
		T_N &= \{\texttt{ }\} \\
		T_P &= \{\texttt{ }\} \\
		T_V &= \{\texttt{S}\} 
	\end{align*}
};
\end{tikzpicture}
\end{center}

Append the satisfying literal $x_1$ to the required variable tube $T_V$.

\begin{center}
\begin{tikzpicture}
\node[fill=lightgray, rounded corners=5pt, text width=3in]{
	\[
		T_V = \{\texttt{S+1}\}
	\]
	\begin{align*}
		T_V = \{ &5'-\underbrace{\texttt{TTG}}_{\text{Start}}\cdot\underbrace{\texttt{TTT}}_{ x_{1}} -3' \}
	\end{align*}
};
\end{tikzpicture}
\end{center}

 Mix the contents of $T_C$, $T_P$, and $T_V$ into the clause witness tube $T_C$.

\begin{center}
\begin{tikzpicture}
\node[fill=lightgray, rounded corners=5pt, text width=3in]{
	\[
		T_C = \{\texttt{S+1}\}
	\]
	\begin{align*}
	T_C = \{ &5'-\underbrace{\texttt{TTG}}_{\text{Start}}\cdot\underbrace{\texttt{TTT}}_{ x_{1}} -3' \}
	\end{align*}	
};
\end{tikzpicture}
\end{center}


%%%%%%%%%%%%

%%%%%%%%%%%%
Select the literal $x_2$ from $C_1$.  Split the contents of $T_S$:

%\begin{center}
%\begin{tikzpicture}
%\node[fill=gray, rounded corners=5pt, text width=6in]{
%	\makebox[\textwidth][r]{
%		\begin{minipage}[t]{0.5\textwidth}
%			\begin{center}
%			\begin{tikzpicture}
%			\node[fill=lightgray, rounded corners=5pt, text width=2.5in]{		
%				\[
%					T_V = \{\texttt{S}\}
%				\]
%			};
%			\end{tikzpicture}
%			\end{center}				
%		\end{minipage}				
%		\begin{minipage}[t]{0.5\textwidth}
%			\begin{center}
%			\begin{tikzpicture}
%			\node[fill=lightgray, rounded corners=5pt, text width=2.5in]{
%				\[
%					T_S = \{\texttt{S}\}
%				\]
%			};
%			\end{tikzpicture}
%			\end{center}				
%		\end{minipage}		
%	}
%};
%\end{tikzpicture}
%\end{center}

\begin{center}
\begin{tikzpicture}
\node[fill=gray, rounded corners=5pt, text width=6in]{
	\makebox[\textwidth][r]{
		\begin{minipage}[t]{0.5\textwidth}
			\begin{center}
			\begin{tikzpicture}
			\node[fill=lightgray, rounded corners=5pt, text width=2.5in]{
				
				\[
				T_V = \{
			\texttt{S}
				\}
				\]
				\begin{align*}
				T_V = \{ 
			&5'-\underbrace{\texttt{TTG}}_{\text{Start}} -3' \}
				\end{align*}
			};
			\end{tikzpicture}
			\end{center}			
		\end{minipage}				
		\begin{minipage}[t]{0.5\textwidth}
			\begin{center}
			\begin{tikzpicture}
			\node[fill=lightgray, rounded corners=5pt, text width=2.5in]{
				
				\[
				T_S = \{
			\texttt{S}
				\}
				\]
				\begin{align*}
				T_S = \{ &5'-\underbrace{\texttt{TTG}}_{\text{Start}} -3' \}
				\end{align*}
			};
			\end{tikzpicture}
			\end{center}			
		\end{minipage}		
	}
};
\end{tikzpicture}
\end{center}

\hspace{1em}


Extract literals from $T_V$ that contain negative and positive assignments for $x_2$.

\begin{center}
\begin{tikzpicture}
\node[fill=lightgray, rounded corners=5pt, text width=3in]{
	\begin{align*}
		T_N &= \{\texttt{ }\} \\
		T_P &= \{\texttt{ }\} \\
		T_V &= \{\texttt{S}\} 
	\end{align*}
};
\end{tikzpicture}
\end{center}

Append the satisfying literal $x_2$ to the required variable tube $T_V$.

%\begin{center}
%\begin{tikzpicture}
%\node[fill=lightgray, rounded corners=5pt, text width=3in]{
%	\[
%		T_V = \{\texttt{S+2}\}
%	\]
%};
%\end{tikzpicture}
%\end{center}

\begin{center}
\begin{tikzpicture}
\node[fill=lightgray, rounded corners=5pt, text width=3in]{
	\[
		T_V = \{\texttt{S+2}\}
	\]
	\begin{align*}
		T_V = \{ &5'-\underbrace{\texttt{TTG}}_{\text{Start}}\cdot\underbrace{\texttt{CTT}}_{ x_{2}} -3' \}
	\end{align*}
};
\end{tikzpicture}
\end{center}


 Mix the contents of $T_C$, $T_P$, and $T_V$ into the clause witness tube $T_C$.

%\begin{center}
%\begin{tikzpicture}
%\node[fill=lightgray, rounded corners=5pt, text width=3in]{
%	\[
%		T_C = \{\texttt{S+1, S+2}\}
%	\]
%};
%\end{tikzpicture}
%\end{center}

\begin{center}
\begin{tikzpicture}
\node[fill=lightgray, rounded corners=5pt, text width=3in]{
	\[
		T_C = \{\texttt{S+1, S+2}\}
	\]
	\begin{align*}
		T_C = \{ &5'-\underbrace{\texttt{TTG}}_{\text{Start}}\cdot\underbrace{\texttt{TTT}}_{ x_{1}} - 3', \\
				 &5'-\underbrace{\texttt{TTG}}_{\text{Start}}\cdot\underbrace{\texttt{CTT}}_{ x_{2}} - 3' \}
	\end{align*}
};
\end{tikzpicture}
\end{center}

Complete the iteration of the first clause by storing the witnesses in $T_C$ as witnesses to $T_S$ for the evaluated instance $\phi$.

%\begin{center}
%\begin{tikzpicture}
%\node[fill=lightgray, rounded corners=5pt, text width=3in]{
%	\[
%		T_S = \{\texttt{S+1, S+2}\}
%	\]
%};
%\end{tikzpicture}
%\end{center}

\begin{center}
\begin{tikzpicture}
\node[fill=lightgray, rounded corners=5pt, text width=3in]{
	\[
		T_S = \{\texttt{S+1, S+2}\}
	\]
	\begin{align*}
		T_S = \{ &5'-\underbrace{\texttt{TTG}}_{\text{Start}}\cdot\underbrace{\texttt{TTT}}_{ x_{1}} - 3', \\
				 &5'-\underbrace{\texttt{TTG}}_{\text{Start}}\cdot\underbrace{\texttt{CTT}}_{ x_{2}} - 3' \}
	\end{align*}
};
\end{tikzpicture}
\end{center}

%%%%%%%%%%%%%%%%%%%%%


Evaluate clause $C_2 = (x_1 \vee \neg x_2 \vee x_3)$:

\begin{center}
\begin{tikzpicture}
\node[fill=lightgray, rounded corners=5pt, text width=3in]{
	\[
		T_C = \{\texttt{ }\}
	\]
};
\end{tikzpicture}
\end{center}

%%%%%%
Select the literal $x_1$ from $C_2$.  Split the contents of $T_S$:

\begin{center}
\begin{tikzpicture}
\node[fill=gray, rounded corners=5pt, text width=6in]{
	\makebox[\textwidth][r]{
		\begin{minipage}[t]{0.5\textwidth}
			\begin{center}
			\begin{tikzpicture}
			\node[fill=lightgray, rounded corners=5pt, text width=2.5in]{
				\[
					T_V = \{\texttt{S+1, S+2}\}
				\]
				\begin{align*}
					T_V = \{ &5'-\underbrace{\texttt{TTG}}_{\text{Start}}\cdot\underbrace{\texttt{TTT}}_{ x_{1}} - 3', \\
							 &5'-\underbrace{\texttt{TTG}}_{\text{Start}}\cdot\underbrace{\texttt{CTT}}_{ x_{2}} - 3' \}
				\end{align*}
			};
			\end{tikzpicture}
			\end{center}				
		\end{minipage}				
		\begin{minipage}[t]{0.5\textwidth}
			\begin{center}
			\begin{tikzpicture}
			\node[fill=lightgray, rounded corners=5pt, text width=2.5in]{
				\[
					T_S = \{\texttt{S+1, S+2}\}
				\]
				\begin{align*}
					T_S = \{ &5'-\underbrace{\texttt{TTG}}_{\text{Start}}\cdot\underbrace{\texttt{TTT}}_{ x_{1}} - 3', \\
							 &5'-\underbrace{\texttt{TTG}}_{\text{Start}}\cdot\underbrace{\texttt{CTT}}_{ x_{2}} - 3' \}
				\end{align*}
			};
			\end{tikzpicture}
			\end{center}				
		\end{minipage}		
	}
};
\end{tikzpicture}
\end{center}
	
\hspace{1em}

Extract literals from $T_V$ that contain negative and positive assignments for $x_1$.

\begin{center}
\begin{tikzpicture}
\node[fill=lightgray, rounded corners=5pt, text width=3in]{
	\begin{align*}
		T_N &= \{ \}\\
		T_P &= \{\texttt{S+1}\}\\
		T_V &= \{\texttt{S+2}\}\\
	\end{align*}
};
\end{tikzpicture}
\end{center}

Append the satisfying literal $x_1$ to the required variable tube $T_V$.

%\begin{center}
%\begin{tikzpicture}
%\node[fill=lightgray, rounded corners=5pt, text width=3in]{
%	\[
%		T_V = \{\texttt{S+2+1}\} 
%	\]
%};
%\end{tikzpicture}
%\end{center}

\begin{center}
\begin{tikzpicture}
\node[fill=lightgray, rounded corners=5pt, text width=3in]{
	\[
		T_V = \{\texttt{S+2+1}\}
	\]
	\begin{align*}
		T_V = \{ &5'-\underbrace{\texttt{TTG}}_{\text{Start}}\cdot\underbrace{\texttt{CTT}}_{ x_{2}}\cdot\underbrace{\texttt{TTT}}_{ x_{1}} - 3' \}
	\end{align*}
};
\end{tikzpicture}
\end{center}

 Mix the contents of $T_C$, $T_P$, and $T_V$ into the clause witness tube $T_C$.

%\begin{center}
%\begin{tikzpicture}
%\node[fill=lightgray, rounded corners=5pt, text width=3in]{
%	\[
%		T_C = \{\texttt{S+1, S+2+1}\}
%	\]
%};
%\end{tikzpicture}
%\end{center}


\begin{center}
\begin{tikzpicture}
\node[fill=lightgray, rounded corners=5pt, text width=3in]{
	\[
		T_C = \{\texttt{S+1, S+2+1}\}
	\]
	\begin{align*}
		T_C = \{ &5'-\underbrace{\texttt{TTG}}_{\text{Start}}\cdot\underbrace{\texttt{TTT}}_{ x_{1}} - 3', \\
				 &5'-\underbrace{\texttt{TTG}}_{\text{Start}}\cdot\underbrace{\texttt{CTT}}_{ x_{2}}\cdot\underbrace{\texttt{TTT}}_{ x_{1}} - 3' \}
	\end{align*}
};
\end{tikzpicture}
\end{center}

%%%%%%%
Select the literal $\neg x_2$ from $C_2$.  Split the contents of $T_S$:

\begin{center}
\begin{tikzpicture}
\node[fill=gray, rounded corners=5pt, text width=6in]{
	\makebox[\textwidth][r]{
		\begin{minipage}[t]{0.5\textwidth}
			\begin{center}
			\begin{tikzpicture}
			\node[fill=lightgray, rounded corners=5pt, text width=2.5in]{
				\[
					T_V = \{\texttt{S+1, S+2}\}
				\]
				\begin{align*}
					T_V = \{ &5'-\underbrace{\texttt{TTG}}_{\text{Start}}\cdot\underbrace{\texttt{TTT}}_{ x_{1}} - 3', \\
							 &5'-\underbrace{\texttt{TTG}}_{\text{Start}}\cdot\underbrace{\texttt{CTT}}_{ x_{2}} - 3' \}
				\end{align*}
			};
			\end{tikzpicture}
			\end{center}				
		\end{minipage}				
		\begin{minipage}[t]{0.5\textwidth}
			\begin{center}
			\begin{tikzpicture}
			\node[fill=lightgray, rounded corners=5pt, text width=2.5in]{
				\[
					T_S = \{\texttt{S+1, S+2}\}
				\]
				\begin{align*}
					T_S = \{ &5'-\underbrace{\texttt{TTG}}_{\text{Start}}\cdot\underbrace{\texttt{TTT}}_{ x_{1}} - 3', \\
							 &5'-\underbrace{\texttt{TTG}}_{\text{Start}}\cdot\underbrace{\texttt{CTT}}_{ x_{2}} - 3' \}
				\end{align*}
			};
			\end{tikzpicture}
			\end{center}				
		\end{minipage}		
	}
};
\end{tikzpicture}
\end{center}
	
\hspace{1em}

Extract literals from $T_V$ that contain negative and positive assignments for $\neg x_2$.

\begin{center}
\begin{tikzpicture}
\node[fill=lightgray, rounded corners=5pt, text width=3in]{
	\begin{align*}
		T_N &= \{\texttt{S+2}\}\\
		T_P &= \{\texttt{}\}\\
		T_V &= \{\texttt{S+1}\}
	\end{align*}
};
\end{tikzpicture}
\end{center}

Append the satisfying literal $\neg x_2$ to the required variable tube $T_V$.

%\begin{center}
%\begin{tikzpicture}
%\node[fill=lightgray, rounded corners=5pt, text width=3in]{
%	\[
%		T_V = \{\texttt{S+1-2}\}
%	\]
%};
%\end{tikzpicture}
%\end{center}

\begin{center}
\begin{tikzpicture}
\node[fill=lightgray, rounded corners=5pt, text width=3in]{
	\[
		T_V = \{\texttt{S+1-2}\}
	\]
	\begin{align*}
		T_V = \{ &5'-\underbrace{\texttt{TTG}}_{\text{Start}}\cdot\underbrace{\texttt{TTT}}_{ x_{1}}\cdot\underbrace{\texttt{ATT}}_{\neg x_{2}} - 3' \}
	\end{align*}
};
\end{tikzpicture}
\end{center}

 Mix the contents of $T_C$, $T_P$, and $T_V$ into the clause witness tube $T_C$.

\begin{center}
\begin{tikzpicture}
\node[fill=lightgray, rounded corners=5pt, text width=3in]{
	\begin{align*}
		T_C = \{&\texttt{S+1, S+2+1}, \\
				&\texttt{S+1-2}\}
	\end{align*}
	\begin{align*}
		T_C = \{ &5'-\underbrace{\texttt{TTG}}_{\text{Start}}\cdot\underbrace{\texttt{TTT}}_{ x_{1}} - 3', \\
				 &5'-\underbrace{\texttt{TTG}}_{\text{Start}}\cdot\underbrace{\texttt{CTT}}_{ x_{2}}\cdot\underbrace{\texttt{TTT}}_{ x_{1}} - 3', \\
				 &5'-\underbrace{\texttt{TTG}}_{\text{Start}}\cdot\underbrace{\texttt{TTT}}_{ x_{1}}\cdot\underbrace{\texttt{ATT}}_{\neg x_{2}} - 3' \}
	\end{align*}	
};
\end{tikzpicture}
\end{center}

%%%%%%%%%%%%
Select the literal $x_3$ from $C_2$.  Split the contents of $T_S$:

\begin{center}
\begin{tikzpicture}
\node[fill=gray, rounded corners=5pt, text width=6in]{
	\makebox[\textwidth][r]{
		\begin{minipage}[t]{0.5\textwidth}
			\begin{center}
			\begin{tikzpicture}
			\node[fill=lightgray, rounded corners=5pt, text width=2.5in]{
				\[
					T_V = \{\texttt{S+1, S+2}\}
				\]
				\begin{align*}
					T_V = \{ &5'-\underbrace{\texttt{TTG}}_{\text{Start}}\cdot\underbrace{\texttt{TTT}}_{ x_{1}} - 3', \\
							 &5'-\underbrace{\texttt{TTG}}_{\text{Start}}\cdot\underbrace{\texttt{CTT}}_{ x_{2}} - 3' \}
				\end{align*}
			};
			\end{tikzpicture}
			\end{center}				
		\end{minipage}				
		\begin{minipage}[t]{0.5\textwidth}
			\begin{center}
			\begin{tikzpicture}
			\node[fill=lightgray, rounded corners=5pt, text width=2.5in]{
				\[
					T_S = \{\texttt{S+1, S+2}\}
				\]
				\begin{align*}
					T_S = \{ &5'-\underbrace{\texttt{TTG}}_{\text{Start}}\cdot\underbrace{\texttt{TTT}}_{ x_{1}} - 3', \\
							 &5'-\underbrace{\texttt{TTG}}_{\text{Start}}\cdot\underbrace{\texttt{CTT}}_{ x_{2}} - 3' \}
				\end{align*}
			};
			\end{tikzpicture}
			\end{center}				
		\end{minipage}		
	}
};
\end{tikzpicture}
\end{center}
		
\hspace{1em}


Extract literals from $T_V$ that contain negative and positive assignments for $x_3$.

\begin{center}
\begin{tikzpicture}
\node[fill=lightgray, rounded corners=5pt, text width=3in]{
	\begin{align*}
		T_N &= \{\texttt{}\}\\
		T_P &= \{\texttt{}\} \\
		T_V &= \{\texttt{S+1, S+2}\}
	\end{align*}
};
\end{tikzpicture}
\end{center}

Append the satisfying literal $x_3$ to the required variable tube $T_V$.

%\begin{center}
%\begin{tikzpicture}
%\node[fill=lightgray, rounded corners=5pt, text width=3in]{
%	\[
%		T_V = \{\texttt{S+1+3, S+2+3}\}
%	\]
%};
%\end{tikzpicture}
%\end{center}

\begin{center}
\begin{tikzpicture}
\node[fill=lightgray, rounded corners=5pt, text width=3in]{
	\[
		T_V = \{\texttt{S+1+3, S+2+3}\}
	\]
	\begin{align*}
		T_V = \{ &5'-\underbrace{\texttt{TTG}}_{\text{Start}}\cdot\underbrace{\texttt{TTT}}_{ x_{1}}\cdot\underbrace{\texttt{ATG}}_{ x_{3}} - 3', \\
				 &5'-\underbrace{\texttt{TTG}}_{\text{Start}}\cdot\underbrace{\texttt{CTT}}_{ x_{2}}\cdot\underbrace{\texttt{ATG}}_{ x_{3}} - 3' \}
	\end{align*}
};
\end{tikzpicture}
\end{center}

 Mix the contents of $T_C$, $T_P$, and $T_V$ into the clause witness tube $T_C$.

%\begin{center}
%\begin{tikzpicture}
%\node[fill=lightgray, rounded corners=5pt, text width=3.5in]{
%	\begin{align*}
%		T_C = \{&\texttt{S+1, S+2+1}, \\
%				&\texttt{S+1-2}, \\
%				&\texttt{S+1+3, S+2+3}\}
%	\end{align*}
%};
%\end{tikzpicture}
%\end{center}

\begin{center}
\begin{tikzpicture}
\node[fill=lightgray, rounded corners=5pt, text width=3in]{
	\begin{align*}
		T_C = \{&\texttt{S+1, S+2+1}, \\
				&\texttt{S+1-2},\\
				&\texttt{S+1+3, S+2+3}\}
	\end{align*}
	\begin{align*}
		T_C = \{ &5'-\underbrace{\texttt{TTG}}_{\text{Start}}\cdot\underbrace{\texttt{TTT}}_{ x_{1}} - 3', \\
				 &5'-\underbrace{\texttt{TTG}}_{\text{Start}}\cdot\underbrace{\texttt{CTT}}_{ x_{2}}\cdot\underbrace{\texttt{TTT}}_{ x_{1}} - 3', \\
				 &5'-\underbrace{\texttt{TTG}}_{\text{Start}}\cdot\underbrace{\texttt{TTT}}_{ x_{1}}\cdot\underbrace{\texttt{ATT}}_{\neg x_{2}} - 3',\\
				 &5'-\underbrace{\texttt{TTG}}_{\text{Start}}\cdot\underbrace{\texttt{TTT}}_{ x_{1}}\cdot\underbrace{\texttt{ATG}}_{ x_{3}} - 3', \\
				 &5'-\underbrace{\texttt{TTG}}_{\text{Start}}\cdot\underbrace{\texttt{CTT}}_{ x_{2}}\cdot\underbrace{\texttt{ATG}}_{ x_{3}} - 3' \}
	\end{align*}	
};
\end{tikzpicture}
\end{center}

%%%%%%%%%%%%

Complete the iteration of the last clause by storing the witnesses in $T_C$ as witnesses to $T_S$.  The tube $T_S$ contains witnesses for $\phi$.

\begin{center}
\begin{tikzpicture}
\node[fill=lightgray, rounded corners=5pt, text width=3in]{
	\begin{align*}
		T_S = \{&\texttt{S+1, S+2+1}, \\
				&\texttt{S+1-2},\\
				&\texttt{S+1+3, S+2+3}\}
	\end{align*}
	\begin{align*}
		T_S = \{ &5'-\underbrace{\texttt{TTG}}_{\text{Start}}\cdot\underbrace{\texttt{TTT}}_{ x_{1}} - 3', \\
				 &5'-\underbrace{\texttt{TTG}}_{\text{Start}}\cdot\underbrace{\texttt{CTT}}_{ x_{2}}\cdot\underbrace{\texttt{TTT}}_{ x_{1}} - 3', \\
				 &5'-\underbrace{\texttt{TTG}}_{\text{Start}}\cdot\underbrace{\texttt{TTT}}_{ x_{1}}\cdot\underbrace{\texttt{ATT}}_{\neg x_{2}} - 3',\\
				 &5'-\underbrace{\texttt{TTG}}_{\text{Start}}\cdot\underbrace{\texttt{TTT}}_{ x_{1}}\cdot\underbrace{\texttt{ATG}}_{ x_{3}} - 3', \\
				 &5'-\underbrace{\texttt{TTG}}_{\text{Start}}\cdot\underbrace{\texttt{CTT}}_{ x_{2}}\cdot\underbrace{\texttt{ATG}}_{ x_{3}} - 3' \}
	\end{align*}	
};
\end{tikzpicture}
\end{center}




	
	
\subsection{Detailed trace of the Distribution algorithm}

Appendix B lists a detailed execution trace for the Distribution algorithm.

%
%\section{Simulation of distribution algorithm}
%
%\section{Physical construction of distribution algorithm}
%	
