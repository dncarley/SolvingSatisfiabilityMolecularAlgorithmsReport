
\chapter{Molecular algorithm trace}

\section{Example {\sc Satisfiability} instance}


\[
 \phi = (x_1 \vee x_2 \vee \neg x_3) \wedge  (x_2 \vee x_3 \vee \neg x_4) \wedge (\neg x_1 \vee \neg x_3 \vee \neg x_4)
\]


\section{Lipton's Algorithm}

\[
T  = \text{{\sc Combinatorial Generate}}(4)
\]

\[
T = 
\]
\begin{verbatim}
	STTTT SFTTT STFTT SFFTT STTFT SFTFT STFFT SFFFT
	STTTF SFTTF STFTF SFFTF STTFF SFTFF STFFF SFFFF
\end{verbatim}
	
Next select Clause 1:

\[
C_1 = (x_1 \vee x_2 \vee \neg x_3)
\]

\begin{verbatim}
	STTTT SFTTT STFTT SFFTT STTFT SFTFT STFFT SFFFT
	STTTF SFTTF STFTF SFFTF STTFF SFTFF STFFF SFFFF
\end{verbatim}
	
	Extract $x_1$:

\begin{verbatim}
		STTTT      STFTT      STTFT      STFFT     
		STTTF      STFTF      STTFF      STFFF     
\end{verbatim}

	Extract $x_2$:
\begin{verbatim}
		STTTT SFTTT           STTFT SFTFT          
		STTTF SFTTF           STTFF SFTFF          
\end{verbatim}

	Extract $\neg x_3$:
\begin{verbatim}	
		                    STTFT SFTFT STFFT SFFFT
		                    STTFF SFTFF STFFF SFFFF
\end{verbatim}		                    

	Mix contents:

\begin{verbatim}	
		STTTT SFTTT STFTT      STTFT SFTFT STFFT SFFFT
		STTTF SFTTF STFTF      STTFF SFTFF STFFF SFFFF
\end{verbatim}		

Next select Clause 2:

\[
C_2 = (x_2 \vee x_3 \vee \neg x_4)
\]

\begin{verbatim}
	STTTT SFTTT STFTT      STTFT SFTFT STFFT SFFFT
	STTTF SFTTF STFTF      STTFF SFTFF STFFF SFFFF
\end{verbatim}		

	Extract $x_2$:
\begin{verbatim}
		STTTT SFTTT           STTFT SFTFT          
		STTTF SFTTF           STTFF SFTFF          
\end{verbatim}	

	Extract $x_3$:
\begin{verbatim}	
		STTTT SFTTT STFTT                         
		STTTF SFTTF STFTF                         
\end{verbatim}	

	Extract $\neg x_4$:
\begin{verbatim}
		                                       
		STTTF SFTTF STFTF      STTFF SFTFF STFFF SFFFF	
\end{verbatim}

	Mix contents:
\begin{verbatim}
		STTTT SFTTT STFTT      STTFT SFTFT          
		STTTF SFTTF STFTF      STTFF SFTFF STFFF SFFFF
\end{verbatim}

Finally, select Clause 3:	
\[
C_3 = (\neg x_1 \vee \neg x_3 \vee x_4)
\]
\begin{verbatim}
	STTTT SFTTT STFTT      STTFT SFTFT          
	STTTF SFTTF STFTF      STTFF SFTFF STFFF SFFFF
\end{verbatim}	
	Extract $\neg x_1$:
\begin{verbatim}
		     SFTTT                SFTFT          
		     SFTTF                SFTFF      SFFFF
\end{verbatim}

	Extract $\neg x_3$:
\begin{verbatim}
		                    STTFT SFTFT          
		                    STTFF SFTFF STFFF SFFFF
\end{verbatim}	

	Extract $x_4$:
\begin{verbatim}
		STTTT SFTTT STFTT      STTFT SFTFT          
		                                       
\end{verbatim}

	Mix contents:
\begin{verbatim}
		STTTT SFTTT STFTT      STTFT SFTFT          
		      SFTTF            STTFF SFTFF STFFF SFFFF
\end{verbatim}





\section{Ogihara and Ray's Algorithm}

Initialize the tube $T$ with initial vector assignments for variables $x_1$ and $x_2$
\[
	T = \{\texttt{STT}, \texttt{STF}, \texttt{SFT}, \texttt{SFF}\}
\]

\noindent Iterate variable $x_3$:
\[
C_1 = (x_1 \vee x_2 \vee \neg x_3)
\]

\noindent $\neg x_3$ matches $v_3$

\begin{align*}
T_{P1} &= \{\texttt{STT}, \texttt{STF}\}\\
T_{N1} &= \{\texttt{SFT}, \texttt{SFF}\}\\
T_{P2} &= \{\texttt{SFT}\}\\
T_P &= \{\texttt{STT}, \texttt{STF}, \texttt{SFT}\}
\end{align*}

\[
C_2 = (x_2 \vee x_3 \vee \neg x_4)
\]
\noindent $x_3$ or $\neg x_3$ does not match $v_3$

\[
C_3 = (\neg x_1 \vee \neg x_3 \vee x_4)
\]
\noindent $x_3$ or $\neg x_3$ does not match $v_3$

\noindent Append

\begin{align*}
T_P &= \{\texttt{STTT}, \texttt{STFT}, \texttt{SFTT}\}\\
T_N &= \{\texttt{STTF}, \texttt{STFF}, \texttt{SFTF}, \texttt{SFFF}\}
\end{align*}

\noindent Mix

\[
T = \{\texttt{STTT}, \texttt{STFT}, \texttt{SFTT}, \texttt{STTF}, \texttt{STFF}, \texttt{SFTF}, \texttt{SFFF}\}
\]


\noindent Iterate variable $x_4$:
\[
C_1 = (x_1 \vee x_2 \vee \neg x_3)
\]

\noindent $x_4$ or $\neg x_4$ does not match $v_3$

\[
C_2 = (x_2 \vee x_3 \vee \neg x_4)
\]
\noindent $\neg x_4$ matchs $v_3$

\begin{align*}
T_{P1} &= \{\texttt{STTT}, \texttt{SFTT}, \texttt{STTF}, \texttt{SFTF}\}\\
T_{N1} &= \{\texttt{STFT}, \texttt{STFF}, \texttt{SFFF}\}\\
T_{P2} &= \{\texttt{STFT}\}\\
T_P &= \{\texttt{STTT}, \texttt{SFTT}, \texttt{STTF}, \texttt{SFTF}, \texttt{STFT}\}
\end{align*}

\[
C_3 = (\neg x_1 \vee \neg x_3 \vee x_4)
\]
\noindent $x_4$ matches $v_3$

\begin{align*}
T_{P1} &= \{\texttt{SFTT}, \texttt{SFTF}, \texttt{SFFF}\}\\
T_{N1} &= \{\texttt{STTT}, \texttt{STFT}, \texttt{STTF}, \texttt{STFF}\}\\
T_{P2} &= \{\texttt{STTF}, \texttt{STFF}\}\\
T_N &= \{\texttt{SFTT}, \texttt{SFTF}, \texttt{SFFF}, \texttt{STTF}, \texttt{STFF}\}
\end{align*}

\noindent Append

\begin{align*}
T_P &= \{\texttt{STTT}, \texttt{STFT}, \texttt{SFTT}\}\\
T_N &= \{\texttt{STTF}, \texttt{STFF}, \texttt{SFTF}, \texttt{SFFF}\}
\end{align*}

\noindent Mix

\[
T = \{\texttt{STTT}, \texttt{STFT}, \texttt{SFTT}, \texttt{STTF}, \texttt{STFF}, \texttt{SFTF}, \texttt{SFFF}\}
\]


\section{Distribution Algorithm}

Initialize the tube $T$ with the variables from the first clause
\[
	T = \{(x_1), (x_2), (\neg x_3)\}
\]	

\noindent Select Clause 2:

\par $T_1 =	\text{{\sc Insert Literal}}(T, x_2)$
\[
		T_1 =  \{(x_1,x_2), (x_2), (x_2,\neg x_3)\}
\]
\par $T_2 =	\text{{\sc Insert Literal}}(T, x_3)$
\[	
		T_2 =  \{(x_1,x_3), (x_2,x_3)\}	
\]
\par $T_3 =	\text{{\sc Insert Literal}}(T, \neg x_4)$
\[	
		T_3 =  \{(x_1,\neg x_4), (x_2,\neg x_4), (\neg x_3,\neg x_4)\}			
\]		
\par $T = \text{mix}(T_1, T_2, T_3)$
\[	
		T = \{(x_1,x_2), (x_2), (x_2,\neg x_3), (x_1, x_3), (x_2,x_3), (x_1,\neg x_4), (x_2,\neg x_4), (\neg x_3,\neg x_4)\}
\]		

\noindent Select Clause 3:
	
\par $T_1 = 	\text{{\sc Insert Literal}}(T, \neg x_1)$
\[
		T_1 = \{(\neg x_1, x_2), (\neg x_1, x_2,\neg x_3), (\neg x_1, x_2, x_3), (\neg x_1, x_2,\neg x_4), (\neg x_1,\neg x_3,\neg x_4)\}
\]	
\par $T_2 =	\text{{\sc Insert Literal}}(T, \neg x_3)$
\[
		T_2 = \{(x_1,x_2,\neg x_3), (x_2,\neg x_3), (x_2,\neg x_3), (x_1,\neg x_3,\neg x_4), (x_2,\neg x_3,\neg x_4), (\neg x_3,\neg x_4)\}
\]
\par $T_2 =	\text{{\sc Insert Literal}}(T, x_4)$
\[
		T_3 = \{(x_1,x_2,x_4), (x_2,x_4), (x_2,\neg x_3,x_4), (x_1,x_3,x_4), (x_2,x_3,x_4)\}
\]
\par $T = \text{mix}(T_1, T_2, T_3)$
\begin{align*}
		T = \{&(\neg x_1,x_2), (\neg x_1,x_2,\neg x_3), (\neg x_1,x_2,x_3), (\neg x_1,x_2,\neg x_4), (\neg x_1,\neg x_3,\neg x_4),\\
			  &(x_1,x_2,\neg x_3), (x_2,\neg x_3), (x_1,\neg x_3,\neg x_4), (x_2,\neg x_3,\neg x_4), (\neg x_3,\neg x_4),\\
			  &(x_1,x_2,x_4), (x_2,x_4), (x_2,\neg x_3,x_4), (x_1,x_3,x_4), (x_2,x_3,x_4)\}
\end{align*}
